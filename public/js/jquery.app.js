(function(){!function(t,e){var n,a,o,i,r,l,c;return r="Chưa có comment nào",i="Để lại comment ở đây",a=function(){function t(){}return t.prototype.stringToItem=function(t){return{tag_id:0,tag_name:t}},t.prototype.itemToString=function(t){return t.tag_name},t.prototype.compareItems=function(t,e){return t.tag_id===e.tag_id},t}(),n=function(){function t(){}return t.prototype.stringToItem=function(t){return{des_name:t}},t.prototype.itemToString=function(t){return t.des_name},t.prototype.compareItems=function(t,e){return t.des_name===e.des_name},t}(),c=function(e){var n;return n={uploadExisting:0,data:"",uploadUrl:"/photo",getToken:function(){return t('input[name="_token"]').val()},callback:function(){},onProgress:function(t){return console.log(t+"% complete")}},n=t.extend(n,e),t.ajax(n.uploadUrl,{type:"POST",data:(n.uploadExisting?"id=":"internal_url=")+n.data}).done(function(t){"function"==typeof n.callback&&n.callback(t)})},l=function(t){var e,n,a,o,i,r;for(i=t.split("&"),r={},e=0,a=i.length;a>e;e++)o=i[e],n=o.split("="),r[n[0]]=n[1];return r},o=function(e){var n;return n={selector:"",getUrl:function(){return""}},n=t.extend(n,e),t(n.selector).comments({noCommentsText:r,profilePictureURL:"https://app.viima.com/static/media/user_profiles/user-icon.png",textareaPlaceholderText:i,fieldMappings:{id:"comment_id",created:"created_at",content:"comment_content",fullname:"author_name",profilePictureURL:"author_avatar",parent:"parent_comment"},getComments:function(e,a){return t.ajax({type:"get",url:n.getUrl(),success:function(t){return console.log(t),e(t)},error:a})},postComment:function(e,a,o){return t.ajax({type:"POST",url:n.getUrl(),data:e,success:function(t){return a(t)},error:o})}})},t.Ulibi={TagItem:a,DestinationItem:n,uploadImage:c,parseQueryString:l},t.fn.extend({addClassIfExist:function(e){return this.each(function(){return t(this).hasClass(e)?t(this):t(this).addClass(e),this})},removeClassIfExist:function(e){return this.each(function(){return t(this).hasClass(e)?t(this).removeClass(e):t(this),this})},UlibiTagEditor:function(e){var n,a;return a={debug:!1,wrapClass:"",tags:[],itemManager:{}},a=t.extend(a,e),n=function(t){a.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){return t(this).width(t(this).parent().innerWidth()-24),t(this).textext({plugins:"tags autocomplete",html:{wrap:'<div class="text-core '+a.wrapClass+'"><div class="text-wrap"></div></div>',tag:'<div class="text-tag"><div class="text-button"><span class="text-label"/><a class="custom-edit"/><a class="text-remove"><i class="fa fa-times"></i></a></div></div>'},ext:{itemManager:a.itemManager}}).bind("getSuggestions",function(e){return function(n,o){var i,r;return r=t(n.target).textext()[0],i=(o?o.query:"")||"",t(e).trigger("setSuggestions",{result:r.itemManager().filter(a.tags,i)})}}(this)),n("UlibiTagEditor worked!")})},UlibiPhotoDragDrop:function(n){var a,o;return o={debug:!1,html:{isDraggingClass:"is-dragging",isDropped:"is-dropped"},getToken:function(){return t('input[name="_token"]').val()},callback:function(){}},o=t.extend(o,n),a=function(t){o.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){"undefined"==typeof e.FileReader&&alert("Trình duyệt của bạn không hỗ trợ kéo & thả File :)"),this.ondragover=function(){return!1},this.ondragend=function(){return!1},this.ondragenter=function(e){return e.stopPropagation(),e.preventDefault(),t(this).addClassIfExist(o.html.isDraggingClass),!1},this.ondragleave=function(){return t(this).removeClassIfExist(o.html.isDraggingClass),!1},this.ondrop=function(e){return function(n){var i,r;return n.stopPropagation(),n.preventDefault(),t(e).hasClass(o.html.isDropped)||t(e).addClass(o.html.isDropped),r=new FileReader,i=n.dataTransfer.files[0],r.onload=function(n){a("[UlibiPhotoDragDrop] file content length: "+n.target.result.length),t.Ulibi.uploadImage({uploadExisting:!1,data:n.target.result,getToken:o.getToken,callback:function(a){"succeeded"===a.status&&(t(e).hasClass("has-image")||t(e).addClass("has-image"),t(e).css("background-image","url("+n.target.result+")"),o.callback(a))}})},r.readAsDataURL(i),!1}}(this),a("UlibiPhotoDragDrop worked!")})},DeleteBlogArticle:function(e){var n,a;return a={debug:!1,csrf_token:"",alert:{title:"Are you sure?",text:"Bạn có chắc chắn muốn xoá bài viết <strong>{title}</strong> không?"},callback:function(){}},a=t.extend(a,e),n=function(t){a.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){t(this).click(function(e){var n,o;n=t(e.target).attr("data-href"),o=t(e.target).attr("data-title"),swal({title:a.alert.title,text:a.alert.text.replace("{title}",o),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Có, xoá nó đi :)",cancelButtonText:"Không :(",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0,html:!0},function(){t.ajax({url:n,type:"DELETE",data:{_token:a.csrf_token},success:function(){return swal({title:"Success",text:"",type:"success"},a.callback)},error:function(){return swal({title:"Failed",text:"",type:"error"},a.callback)}})})}),n("DeleteBlogArticle plugin worked!")})},UlibiImageSelector:function(e){var n,a;return a={debug:!1,html:{uploaderId:"",parentId:"",childrenSelector:""},ajax:{url:"",method:"POST",dataTemplate:"key={0}"},callback:function(){return location.reload(!0)},uploadCallback:null},a=t.extend(a,e),n=function(t){a.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){var e,o,i,r,l,c,s,u,d,f;o="btn-disabled",s=t(this).attr("href"),u=t(s).find("[data-role='change']"),f=t(a.html.uploaderId),l="data-selected",e=JSON.parse(atob(a.ajax)),i=function(o){return function(o){var i,r;i=e.dataTemplate.replace("{0}",o),n(o),r=!1,r||t.ajax({url:e.url,type:e.method,data:i,success:function(t){"OK"===t.status?(n("Change photo success, id="+o),a.callback()):n("Error expected, message: "+t.message)}})}}(this),d=function(e){return function(e){var n;return e.preventDefault(),t(u).hasClass(o)?void 0:(n=t(u).attr(l),i(n),!1)}}(this),c=function(n){return function(){var n;t(u).addClassIfExist(o),t(s).find(a.html.parentId).selectable({filter:a.html.childrenSelector,selected:function(e,n){t(u).removeClassIfExist(o).attr(l,t(n.selected).attr("data-photoid")).on("click",d)}}),n=a.uploadCallback,n||(n=function(t){i(t.id)}),t(f).UlibiPhotoDragDrop({debug:!0,getToken:function(){return t.Ulibi.parseQueryString(e.dataTemplate)._token},callback:n})}}(this),r=function(e){return function(){return t(s).find(a.html.parentId).selectable("destroy"),t(u).off()}}(this),t(this).magnificPopup({type:"inline",preloader:!1,mainClass:"mfp-dialog",callbacks:{beforeOpen:function(){c()},close:function(){r()}}}),n("UlibiImageSelector plugin worked!")})},UlibiProfileInformationEditor:function(e){var n,a;return a={debug:!1,html:{dialogSelector:"",formSelector:""},ajax:{url:"",method:"POST",dataTemplate:"key={0}"},callback:function(){return location.reload(!0)}},a=t.extend(a,e),n=function(t){a.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){t(this).magnificPopup({type:"inline",preloader:!1,mainClass:"mfp-dialog",callbacks:{open:function(e){return function(){var n;n=t(e).attr("data-tab"),t(a.html.dialogSelector+' a[href="#tab-'+n+'"]').tab("show")}}(this),close:function(e){return function(){t(a.html.dialogSelector+' a[href="#tab-0"]').tab("show")}}(this)}}),n("UlibiProfileInformationEditor worked!")})},UlibiShowImage:function(n){var a,i;return i={debug:!1,html:{dialogSelector:"",formSelector:""}},i=t.extend(i,n),a=function(t){i.debug&&"undefined"!=typeof console&&null!==console&&console.log(t)},this.each(function(){var n,i,r,l,c,s;r=JSON.parse(atob(t(this).attr("data-encoded"))),n=JSON.parse(atob(t(this).attr("data-author-encoded"))),i=JSON.parse(atob(t(this).attr("data-content-encoded"))),s=!1,e.authToken&&atob(e.authToken)===n.username&&(s=!0),a(s),c=function(e){return t.ajax({type:"POST",url:"/ulibier/like",data:"content_id="+i.content_id,success:function(e){return function(n){a(e),"like"===n.action?t(e).find("i").removeClassIfExist("fa-heart-o").addClassIfExist("fa-heart"):t(e).find("i").removeClassIfExist("fa-heart").addClassIfExist("fa-heart-o"),t(e).next().text(n.like_count)}}(this)})},l=function(){var e;e=confirm("Bạn có chắc chắn muốn xoá ảnh này không?"),e&&t.ajax({type:"delete",url:"/photo/"+i.content_id,success:function(){return location.reload(!0)},error:function(t){return a(t)}})},t(this).magnificPopup({type:"image",closeBtnInside:!1,image:{verticalFit:!1,markup:"<div class=\"mfp-figure image-show\">\n  <div class='row'>\n    <div class='col-sm-8'>\n      <div class=\"mfp-img\"></div>\n      <div class='img-toolbar'>\n        "+(s?"<div class='btn btn-default delete-image'>Xoá ảnh</div>":void 0)+'\n      </div>\n    </div>\n    <div class="col-sm-4 img-content">\n      <div class=\'divide20\'></div>\n      <h5 class="img-show-author"><a href="/profile/'+n.username+'">'+n.full_name+'</a></h5>\n      <p class="img-show-title">'+r.photo_description+"</p>\n      <p class='img-show-counter'><a class='img-like' href='javascript:void(0)'><i class=\"fa "+(i.liked?"fa-heart":"fa-heart-o")+"\"></i></a><span class='like-count'>"+i.like_count+"</span></p>\n      <div id='comment-container-photo'>\n      </div>\n    </div>\n  </div>\n</div>",titleSrc:function(t){var e;return e=t.el.attr("title")}},callbacks:{imageLoadComplete:function(e){var n,a,r,s;return r=t(this.content).find("img.mfp-img")[0],t(this.content).parent().width(3*r.naturalWidth/2),s=t(this.content).find("a.img-like")[0],t(s).unbind("click"),t(s).click(c),a=t(this.content).find("div.delete-image")[0],a&&(t(a).unbind("click"),t(a).click(l)),n=t(this.content).find("div#comment-container-photo")[0],o({selector:t(n),getUrl:function(){return"/photo/"+i.content_id+"/comment"}})}}}),a("UlibiShowImage worked!")})},UlibiArticleComment:function(){return this.each(function(){var e,n,a;return n=t(this).data("id"),a="/blog/"+n+"/comment",e=function(){return a},o({selector:this,getUrl:e})})}})}(jQuery,window)}).call(this);
//# sourceMappingURL=jquery.app.js.map
